<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urban Bites | Your Cart</title>
    <link rel="icon" type="image/x-icon" href="Images/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Syne:wght@400;700;800&family=Big+Shoulders+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="CSS/orderpage.css">
</head>

<body>
    <div class="cursor-dot" id="cursor-dot"></div>
    <div class="cursor-outline" id="cursor-outline"></div>
    <div class="noise-overlay"></div>

    <header id="main-header">
        <nav>
            <div class="logo-container">
                <img src='Images/Logo.png' alt="Urban Bites Logo" class="nav-logo">
                <span class="brand-name">Urban Bites</span>
            </div>
            <ul class="nav-links">
                <li><a href="homepage.html" class="hover-target">Home</a></li>
                <li><a href="menupage.html" class="hover-target">Menu</a></li>
                <li><a href="homepage.html#review" class="hover-target">Reviews</a></li>
                <li><a href="#footer" class="hover-target">Contact</a></li>
                <li><a href="orderpage.html" class="cta-button hover-target active">Cart <span
                            id="cart-count">(0)</span></a></li>
            </ul>
            <div class="burger hover-target" onclick="toggleMobileMenu()">
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
            </div>
        </nav>
    </header>

    <div class="page-overlay"></div>

    <div class="main-container">
        <div class="form-header reveal-text">
            <h3 class="section-label">FINALIZE YOUR ORDER</h3>
            <h2 class="hero-title">Your <span class="highlight">Cart</span></h2>
        </div>

        <div class="order-form-wrapper reveal-fade">
            <div id="cart-items-container">
            </div>
            <p id="empty-cart-msg" style="text-align: center; color: #fff; display: none;">Your cart is empty. <a
                    href="menupage.html" class="highlight hover-target">Go to Menu</a></p>

            <div class="order-summary" id="order-summary-box">
                <div class="summary-row"><span>Subtotal</span><span id="subtotal-price">Rs 0</span></div>
                <div class="summary-row"><span>Delivery Fee</span><span>Rs 350</span></div>
                <div class="summary-row total"><span>Total</span><span id="total-price" class="highlight">Rs 350</span>
                </div>
            </div>

            <form id="orderForm" onsubmit="handleOrderSubmit(event)" style="display: none;">
                <div class="form-section">
                    <h3>Delivery Details</h3>
                    <div class="input-group"><label for="name">Full Name</label><input type="text" id="name" name="name"
                            required placeholder="John Doe"></div>
                    <div class="input-group"><label for="contact">Contact Number</label><input type="tel" id="contact"
                            name="contact" required placeholder="077 123 4567"></div>
                    <div class="input-group"><label for="email">Email Address</label><input type="email" id="email"
                            name="email" required placeholder="john@example.com"></div>
                    <div class="input-group"><label for="address">Delivery Address</label><textarea id="address"
                            name="address" rows="3" required placeholder="No. 10, Street Name, City"></textarea></div>
                </div>

                <div class="form-section">
                    <h3>Payment Method</h3>
                    <div class="payment-methods">
                        <label class="radio-label hover-target"><input type="radio" name="payment" value="cod"
                                checked><span class="radio-custom"></span>Cash on Delivery</label>
                        <label class="radio-label hover-target"><input type="radio" name="payment" value="card"><span
                                class="radio-custom"></span>Card Payment</label>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="submit-btn hover-target">PLACE ORDER</button>
                    <a href="menupage.html" class="back-link hover-target">Add More Items</a>
                </div>
            </form>
        </div>
    </div>

    <footer id="footer" class="footer-modern">
        <div class="container">
            <div class="footer-top">
                <div class="footer-nav">
                    <h3>Explore</h3>
                    <ul>
                        <li><a href="homepage.html" class="hover-target">Home</a></li>
                        <li><a href="menupage.html" class="hover-target">Menu</a></li>
                        <li><a href="homepage.html#about" class="hover-target">About</a></li>
                        <li><a href="homepage.html#review" class="hover-target">Reviews</a></li>
                    </ul>
                </div>
                <div class="footer-nav">
                    <h3>Legal</h3>
                    <ul>
                        <li><a href="#" onclick="openTermsPopup(); return false;" class="hover-target">Terms</a></li>
                        <li><a href="#" onclick="openPrivacyPopup(); return false;" class="hover-target">Privacy</a>
                        </li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Get in Touch</h3>
                    <p><a href="mailto:urbanbites@gmail.com" class="hover-target">urbanbites@gmail.com</a></p>
                    <p>077 012 3456</p>
                    <div class="socials">
                        <a href="#" class="hover-target"><i class="fa fa-facebook"></i></a>
                        <a href="#" class="hover-target"><i class="fa fa-instagram"></i></a>
                        <a href="#" class="hover-target"><i class="fa fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-big-text"><span>URBAN BITES</span></div>
            <div class="footer-copyright">
                <p>&copy; 2025 Urban Bites. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <div id="termsPopup" class="popup">
        <div class="popup-content glass-card">
            <span class="close hover-target" onclick="closeTermsPopup()">&times;</span>
            <h2 class="highlight">Terms & Conditions</h2>
            <div class="scrollable-content">
                <p>...</p>
            </div>
        </div>
    </div>
    <div id="privacyPopup" class="popup">
        <div class="popup-content glass-card">
            <span class="close hover-target" onclick="closePrivacyPopup()">&times;</span>
            <h2 class="highlight">Privacy Policy</h2>
            <div class="scrollable-content">
                <p>...</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            renderCart();
            const pCursor = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
            const dot = document.getElementById('cursor-dot');
            const outline = document.getElementById('cursor-outline');
            window.addEventListener('mousemove', e => {
                pCursor.x = e.clientX; pCursor.y = e.clientY;
                if (dot) { dot.style.top = pCursor.y + 'px'; dot.style.left = pCursor.x + 'px'; }
            });
            let ox = pCursor.x, oy = pCursor.y;
            function animateCursor() {
                ox += (pCursor.x - ox) * 0.5;
                oy += (pCursor.y - oy) * 0.5;
                if (outline) { outline.style.top = oy + 'px'; outline.style.left = ox + 'px'; }
                requestAnimationFrame(animateCursor);
            }
            animateCursor();

            document.querySelectorAll('.hover-target, a, button, input, label').forEach(el => {
                el.addEventListener('mouseenter', () => { if (outline) { outline.style.transform = 'translate(-50%, -50%) scale(2.5)'; outline.style.backgroundColor = 'rgba(255,255,255,0.1)'; } });
                el.addEventListener('mouseleave', () => { if (outline) { outline.style.transform = 'translate(-50%, -50%) scale(1)'; outline.style.backgroundColor = 'transparent'; } });
            });

            // Mobile Menu
            window.toggleMobileMenu = function () {
                const nav = document.querySelector('.nav-links');
                const burger = document.querySelector('.burger');
                nav.classList.toggle('nav-active');
                document.querySelectorAll('.nav-links li').forEach((link, index) => {
                    if (link.style.animation) { link.style.animation = ''; }
                    else { link.style.animation = `navLinkFade 0.5s ease forwards ${index / 7 + 0.3}s`; }
                });
                burger.classList.toggle('toggle');
            };

            const observer = new IntersectionObserver(es => es.forEach(e => { if (e.isIntersecting) e.target.classList.add('active'); }), { threshold: 0.1 });
            document.querySelectorAll('.reveal-text, .reveal-fade').forEach(el => observer.observe(el));
        });

        function renderCart() {
            const container = document.getElementById('cart-items-container');
            const summaryBox = document.getElementById('order-summary-box');
            const form = document.getElementById('orderForm');
            const emptyMsg = document.getElementById('empty-cart-msg');
            const cartCount = document.getElementById('cart-count');
            let cart = JSON.parse(localStorage.getItem('urbanBitesCart')) || [];
            if (cartCount) cartCount.textContent = `(${cart.reduce((a, b) => a + b.quantity, 0)})`;

            if (cart.length === 0) {
                container.innerHTML = "";
                emptyMsg.style.display = 'block';
                summaryBox.style.display = 'none'; form.style.display = 'none'; return;
            }
            emptyMsg.style.display = 'none'; summaryBox.style.display = 'block'; form.style.display = 'block'; container.innerHTML = "";

            let subtotal = 0;
            cart.forEach((item, idx) => {
                subtotal += item.price * item.quantity;
                const row = document.createElement('div'); row.className = 'cart-item-row';
                row.innerHTML = `
                    <div class="cart-img-box"><img src="${item.image}" alt="${item.name}" onerror="this.src='Images/Logo.png'"></div>
                    <div class="cart-details"><h4>${item.name}</h4>
                        <div class="cart-controls"><span class="price">Rs ${item.price}</span>
                            <div class="qty-control"><button type="button" onclick="updateQty(${idx}, -1)">-</button><span>${item.quantity}</span><button type="button" onclick="updateQty(${idx}, 1)">+</button></div>
                        </div>
                    </div>
                    <button type="button" class="remove-btn hover-target" onclick="removeFromCart(${idx})">&times;</button>`;
                container.appendChild(row);
            });
            document.getElementById('subtotal-price').textContent = `Rs ${subtotal}`;
            document.getElementById('total-price').textContent = `Rs ${subtotal + 350}`;
        }
        window.updateQty = function (idx, chg) {
            let cart = JSON.parse(localStorage.getItem('urbanBitesCart')) || [];
            if (cart[idx]) {
                cart[idx].quantity += chg; if (cart[idx].quantity <= 0) cart.splice(idx, 1);
                localStorage.setItem('urbanBitesCart', JSON.stringify(cart)); renderCart();
            }
        };
        window.removeFromCart = function (idx) {
            let cart = JSON.parse(localStorage.getItem('urbanBitesCart')) || [];
            cart.splice(idx, 1); localStorage.setItem('urbanBitesCart', JSON.stringify(cart)); renderCart();
        };
        window.handleOrderSubmit = function (e) {
            e.preventDefault();
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            const totalText = document.getElementById('total-price').textContent.replace('Rs ', '').trim();

            if (paymentMethod === 'card') {
                window.location.href = `payment.html?total=${totalText}`;
            } else {
                alert("Order Placed Successfully! Cash on Delivery selected.");
                localStorage.removeItem('urbanBitesCart');
                window.location.href = 'homepage.html';
            }
        }
        function openTermsPopup() { document.getElementById("termsPopup").style.display = "block"; }
        function closeTermsPopup() { document.getElementById("termsPopup").style.display = "none"; }
        function openPrivacyPopup() { document.getElementById("privacyPopup").style.display = "block"; }
        function closePrivacyPopup() { document.getElementById("privacyPopup").style.display = "none"; }
        window.onclick = function (e) {
            if (e.target == document.getElementById("termsPopup")) closeTermsPopup();
            if (e.target == document.getElementById("privacyPopup")) closePrivacyPopup();
        };
    </script>
</body>

</html>